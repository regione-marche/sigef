using System;
using System.Web.UI;
using System.Web.UI.WebControls;


namespace web.Private.regione
{
    public partial class Reportistica : SiarLibrary.Web.PrivatePage
    {
        protected override void OnPreInit(EventArgs e)
        {
            this.FunzioneMenu = "bando_reportistica";
            base.OnPreInit(e);
        }

        protected void Page_Load(object sender, EventArgs e)
        {
        }

        protected override void OnPreRender(EventArgs e)
        {

            switch (ucSiarNewTab.TabSelected)
            {
                case 1:
                    tbRiepilogoDomandePagamento.Visible = false;
                    tbRiepilogoElenchiPagamento.Visible = false;
                    tbRiepilogoVarianti.Visible = false;
                    tbRegistroControlli.Visible = false;
                    //ucSiarNewTab.Width = tbRiepilogoBandi.Width;
                    lstStatoProgetto.DataBind();
                    lstProgrammazione.AttivazioneBandi = true;
                    lstProgrammazione.DataBind();
                    if (!string.IsNullOrEmpty(lstStatoProgetto.SelectedValue) && !string.IsNullOrEmpty(lstProgrammazione.SelectedValue))
                    {
                        SiarLibrary.NotAutogeneratedClasses.RiepilogoBandiCollection riepilogobandi = new SiarLibrary.NotAutogeneratedClasses.
                            RiepilogoBandiCollectionProvider().GetRiepilogoBandi(null, lstProgrammazione.SelectedValue, lstStatoProgetto.SelectedValue);
                        dgBando.DataSource = riepilogobandi;
                        dgBando.Titolo = "Elementi trovati: " + riepilogobandi.Count.ToString();
                        dgBando.ItemDataBound += new DataGridItemEventHandler(dgRiepilogoBando_ItemDataBound);
                        dgBando.MostraTotale("DataField", 2, 3, 4, 5);
                        dgBando.DataBind();
                    }
                    break;
                case 2:
                    tbRiepilogoDomandePagamento.Visible = false;
                    tbRiepilogoElenchiPagamento.Visible = false;
                    tbRiepilogoBandi.Visible = false;
                    tbRegistroControlli.Visible = false;
                    lstProgrammazioneVariante.AttivazioneBandi = true;
                    lstProgrammazioneVariante.DataBind();
                    break;
                case 3:
                    tbRiepilogoBandi.Visible = false;
                    tbRiepilogoElenchiPagamento.Visible = false;
                    tbRiepilogoVarianti.Visible = false;
                    tbRegistroControlli.Visible = false;
                    lstProgrammazionePagamento.AttivazioneBandi = true;
                    lstProgrammazionePagamento.DataBind();
                    break;
                case 4:
                    tbRiepilogoBandi.Visible = false;
                    tbRiepilogoDomandePagamento.Visible = false;
                    tbRiepilogoVarianti.Visible = false;
                    tbRegistroControlli.Visible = false;
                    break;
                case 5:
                    tbRiepilogoBandi.Visible = false;
                    tbRiepilogoDomandePagamento.Visible = false;
                    tbRiepilogoElenchiPagamento.Visible = false;
                    tbRiepilogoVarianti.Visible = false;
                    break;
            }
            base.OnPreRender(e);
        }

        void dgRiepilogoBando_ItemDataBound(object sender, DataGridItemEventArgs e)
        {
            DataGridItem dgi=(DataGridItem)e.Item;
            if (dgi.ItemType == ListItemType.Item || dgi.ItemType == ListItemType.AlternatingItem)
            {
                SiarLibrary.NotAutogeneratedClasses.RiepilogoBandi rb = (SiarLibrary.NotAutogeneratedClasses.RiepilogoBandi)e.Item.DataItem;
                if (rb.DisposizioniAttuative)
                {
                    dgi.Style.Add("background-color", "fefeee");
                    dgi.Cells[0].Style.Add("padding-left", "20px");
                    dgi.Cells[0].Style.Add("font-style", "italic");
                    dgi.Cells[0].Text = " - " + e.Item.Cells[0].Text;
                }
            }
        }

        protected void btnApplicaFiltro_Click(object sender, EventArgs e)
        {
        }
    }
}
